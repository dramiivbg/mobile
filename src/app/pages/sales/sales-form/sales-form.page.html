<ion-header>
  <ion-toolbar class="ion-toolbar-backg">
    <ion-buttons slot="start">
      <ion-back-button class="ion-toolbar-button" defaultHref="" (click)="onBack()"></ion-back-button>
    </ion-buttons>
    <ion-title>New</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form [formGroup]="frm">

    <div class="accorn">
      <div class="accorn-title">
        General
      </div>
      <div class="accorn-body">

        <!-- customer  -->
        <ion-row>
          <ion-col>Customer</ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="3">
            <ion-input placeholder="No" formControlName="customerNo"></ion-input>
          </ion-col>
          <ion-col size="2" class="btn-align">
            <ion-button class="btn btn-plure" (click)="onCustomer()" type="button">...</ion-button>
          </ion-col>
          <ion-col>
            <ion-input placeholder="Customer name" formControlName="customerName" readonly></ion-input>
          </ion-col>
        </ion-row>

        <!-- ship to -->

        <ion-row>
          <ion-col>Ship to</ion-col>
        </ion-row>
        <ion-row>
          <ion-col size="3">
            <ion-input formControlName="shippingNo" placeholder="No"></ion-input>
          </ion-col>
          <ion-col size="2" class="btn-align">
            <ion-button class="btn btn-plure" (click)="onShipAddress()" type="button">...</ion-button>
          </ion-col>
          <ion-col>
            <ion-input formControlName="shippingName" placeholder="Shipping name" readonly></ion-input>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col>Sales person</ion-col>
          <ion-col>Location</ion-col>
        </ion-row>

        <ion-row>
          <ion-col>Delivery date</ion-col>
          <ion-col>
            <ion-datetime display-format="MM/DD/YYYY" pickerFormat="MM DD YYYY"></ion-datetime>
          </ion-col>
          <ion-col>Order date</ion-col>
          <ion-col>
            <ion-datetime disabled display-format="MM/DD/YYYY" pickerFormat="MM DD YYYY"></ion-datetime>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col>
            Amount ($)
          </ion-col>
          <ion-col>
            Discount ($)
          </ion-col>
          <ion-col>
            Quantity ($)
          </ion-col>
        </ion-row>
      </div>
    </div>

    <div class="accorn">
      <div class="accorn-title">
        Lines
      </div>
      <div  class="accorn-body">
        <div formArrayName="lines" class="lines">
          <!-- <ion-list *ngFor="let item of frm.get('lines')['controls']; let i=index"> -->
          <ion-list *ngFor="let item of frm.get('lines')['controls']; let i=index">
            <div [formGroupName]="i" *ngIf="item.controls.title.value != ''">
              
              <ion-item-sliding>
                <ion-item-options side="start">
                  <ion-item-option color="danger" (click)="onDeleteLine(item)">Delete</ion-item-option>
                </ion-item-options>

                <ion-item>
                  <ion-label class="label-lines">
                    <ion-row>
                      <ion-col size="6" class="label-line-title">
                        {{item.controls.title.value}}
                      </ion-col>
                      <ion-col class="label-line-title" style="text-align: right;">
                        Total ${{item.controls.total.value}}
                      </ion-col>
                    </ion-row>
                    <ion-row>
                      <ion-col size="4" class="label-line">
                        Item No: {{item.controls.id.value}}
                      </ion-col>
                      <ion-col class="label-line">
                        Category: {{item.controls.categoryNo.value}}
                      </ion-col>
                    </ion-row>
                    <ion-row>
                      <ion-col size="4" class="label-line">
                        Quantity: {{item.controls.quantity.value}}
                      </ion-col>
                      <ion-col class="label-line">
                        Unit price: ${{item.controls.unitPrice.value}}
                      </ion-col>
                    </ion-row>
                  </ion-label>
                </ion-item>

                <ion-item-options side="end">
                  <ion-item-option class="item-lines" color="plureBlack">
                    <ion-button color="plureGrey" class="btn-decrement" (click)="onIncDec(i, 0)">-</ion-button>
                    <ion-input color="plureBlack" formControlName="quantity" type="number"></ion-input>
                    <ion-button color="plureGrey" class="btn-increment" (click)="onIncDec(i, 1)">+</ion-button>
                  </ion-item-option>
                </ion-item-options>
              </ion-item-sliding>
            </div>
          </ion-list>
        </div>
        <div class="btn-accord">
          <ion-button class="btn btn-plure accord-btn-add" (click)="onItem()" type="button">+</ion-button>
        </div>
      </div>
    </div>

    <div class="accorn accorn-fields-dynamics">
      <div class="accorn-title">
        Fields
      </div>
      <div class="accorn-body">

        <div *ngFor="let field of fields">

          <ion-grid>
            <ion-row>
              <ion-col *ngIf="!field.system && field.type != 'date'">
                <ion-item>
                  <ion-label position="floating">{{field.name}}</ion-label>
                  <ion-input [max]="field.length" [type]="field.type" [formControlName]="field.id"></ion-input>
                </ion-item>
              </ion-col>
              <ion-col *ngIf="!field.system && field.type == 'date'">
                <ion-item>
                  <ion-label position="floating">{{field.name}}</ion-label>
                  <ion-datetime [formControlName]="field.id" placeholder="Select your date" display-format="MM/DD/YYYY"
                    pickerFormat="MM DD YYYY"></ion-datetime>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-grid>

        </div>

      </div>
    </div>

    <ion-row>
      <ion-col>
        <ion-button class="btn btn-plure">Submit</ion-button>
      </ion-col>
    </ion-row>


  </form>

</ion-content>